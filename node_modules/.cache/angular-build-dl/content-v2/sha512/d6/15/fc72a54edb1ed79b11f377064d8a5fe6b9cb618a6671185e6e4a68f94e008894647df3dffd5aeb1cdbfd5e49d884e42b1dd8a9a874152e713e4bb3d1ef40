{"version":3,"sources":["webpack:///src/app/components/crear-obra/crear-obra.page.html","webpack:///src/app/components/take-photo/take-photo.component.html","webpack:///src/app/components/crear-obra/crear-obra-routing.module.ts","webpack:///src/app/components/crear-obra/crear-obra.module.ts","webpack:///src/app/components/crear-obra/crear-obra.page.scss","webpack:///src/app/components/crear-obra/crear-obra.page.ts","webpack:///src/app/components/take-photo/take-photo.component.scss","webpack:///src/app/components/take-photo/take-photo.component.ts","webpack:///src/app/model/obra.ts"],"names":["routes","path","component","CrearObraPageRoutingModule","imports","forChild","exports","CrearObraPageModule","declarations","CrearObraPage","storage","database","route","router","obraService","notificacionesService","obra","uidCliente","snapshot","paramMap","get","console","log","isUploaded","isUploading","imageCollection","collection","images","valueChanges","codigocliente","idImgObra","saveObra","notificacionToast","url","navigate","error","event","file","item","type","split","fileName","name","Date","getTime","customMetadata","app","fileRef","ref","task","upload","percentaje","percentageChanges","snapshotChanges","pipe","UploadedFileURL","getDownloadURL","subscribe","resp","addImagetoDB","filepath","size","fileSize","snap","totalBytes","image","id","createId","doc","set","then","selector","template","TakePhotoComponent","camera","loadingCtrl","source","imageSelected","uploadFinished","options","quality","destinationType","DestinationType","DATA_URL","encodingType","EncodingType","JPEG","mediaType","MediaType","PICTURE","sourceType","PictureSourceType","CAMERA","getPicture","imageData","base64Image","startUpload","err","PHOTOLIBRARY","emit","byteCharacters","atob","data","Number","length","putString","create","message","loading","present","val","complete","setTimeout","dismiss","downloadURL","JSON","stringify","sizeInBytes","units","power","Math","round","min","pow","formattedSize","unit","Obra"],"mappings":"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","file":"components-crear-obra-crear-obra-module-es5.js","sourcesContent":["export default \"<!-- Large title -->\\n<ion-toolbar>\\n    <ion-title size=\\\"large\\\">Crea tu Obra</ion-title>\\n</ion-toolbar>\\n\\n\\n<ion-content>\\n    <ion-item>\\n        <ion-input placeholder=\\\"Ingresa un titulo\\\" [(ngModel)]=\\\"obra.titulo\\\">Titulo: </ion-input>\\n    </ion-item>\\n    <ion-item>\\n        <ion-input placeholder=\\\"Ingresa una descripcion de tu obra\\\" [(ngModel)]=\\\"obra.descripcion\\\">Descipcion: </ion-input>\\n    </ion-item>\\n    <ion-item>\\n        <ion-label>Selecciona una categoria</ion-label>\\n        <ion-select class=\\\"custom-options\\\" [(ngModel)]=\\\"obra.categoria\\\">\\n            <ion-select-option value=\\\"CARPINTERIA\\\">CARPINTERIA</ion-select-option>\\n            <ion-select-option value=\\\"INDUSTRIAL\\\">INDUSTRIAL</ion-select-option>\\n            <ion-select-option value=\\\"PLOMERIA\\\">PLOMERIA</ion-select-option>\\n            <ion-select-option value=\\\"ARQUITECTURA\\\">ARQUITECTURA</ion-select-option>\\n        </ion-select>\\n    </ion-item>\\n\\n\\n</ion-content>\\n<ion-card class=\\\"ion-text-center\\\" *ngIf=\\\"!isUploading && !isUploaded\\\">\\n    <ion-card-header>\\n        <ion-card-title>Choose Images to Upload</ion-card-title>\\n    </ion-card-header>\\n    <ion-card-content>\\n        <ion-button color=\\\"success\\\" shape=\\\"round\\\" size=\\\"large\\\">\\n            <span>Select Image</span>\\n            <input id=\\\"uploadBtn\\\" type=\\\"file\\\" class=\\\"upload\\\" (change)=\\\"subirImagen($event.target.files)\\\" />\\n        </ion-button>\\n    </ion-card-content>\\n</ion-card>\\n<app-take-photo [source]=\\\"'photo'\\\"></app-take-photo>\\n<footer>\\n    <div style=\\\"margin-left: 25%;\\\">\\n        <ion-button (click)=\\\"guardarObra()\\\" color=\\\" success \\\">Guardar</ion-button>\\n        <ion-button color=\\\"danger \\\">Cancelar</ion-button>\\n    </div>\\n</footer>\";","export default \"<ion-button color=\\\"dark\\\" (click)=\\\"tomarFoto()\\\" *ngIf=\\\"source=='photo'\\\">\\n    <ion-icon name=\\\"camera-outline\\\"></ion-icon> Fotografia\\n</ion-button>\\n<ion-button color=\\\"dark\\\" icon=\\\"image-outline\\\" (click)=\\\"recuperarImgagen()\\\" *ngIf=\\\"source!=='photo'\\\">\\n    <ion-icon name=\\\"image-outline\\\"></ion-icon> Galeria\\n</ion-button>\";","import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\n\nimport { CrearObraPage } from './crear-obra.page';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: CrearObraPage\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class CrearObraPageRoutingModule {}\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\n\nimport { IonicModule } from '@ionic/angular';\nimport { TakePhotoComponent } from '../take-photo/take-photo.component';\n\nimport { CrearObraPageRoutingModule } from './crear-obra-routing.module';\n\nimport { CrearObraPage } from './crear-obra.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    IonicModule,\n    CrearObraPageRoutingModule\n  ],\n  declarations: [CrearObraPage,TakePhotoComponent]\n})\nexport class CrearObraPageModule {}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudHMvY3JlYXItb2JyYS9jcmVhci1vYnJhLnBhZ2Uuc2NzcyJ9 */\";","import { Component, OnInit } from '@angular/core';\nimport { Obra } from '../../model/obra';\nimport { ActivatedRoute, NavigationExtras, Router } from '@angular/router';\nimport { ObrasService } from '../../services/obras.service';\nimport { NotificacionesService } from '../../services/notificaciones.service';\n//IMPORT TO UPLOAD IMAGES BY SCORPION\nimport { AngularFirestore, AngularFirestoreCollection } from '@angular/fire/firestore';\nimport { AngularFireStorage, AngularFireUploadTask } from '@angular/fire/storage';\nimport { Observable } from 'rxjs';\nimport { finalize, tap } from 'rxjs/operators';\nexport interface MyData {\n  name: string;\n  filepath: string;\n  size: number;\n}\n\n\n\n@Component({\n  selector: 'app-crear-obra',\n  templateUrl: './crear-obra.page.html',\n  styleUrls: ['./crear-obra.page.scss'],\n})\nexport class CrearObraPage implements OnInit {\n  task: AngularFireUploadTask;\n  percentaje: Observable<number>;\n  snapshot: Observable<any>;\n  UploadedFileURL: Observable<string>;\n  images: Observable<MyData[]>;\n  fileName:string;\n  fileSize:number;\n  isUploading:boolean;\n  isUploaded:boolean;\n  private imageCollection: AngularFirestoreCollection<MyData>;\n\n  uidCliente:string;\n  idImgObra:string;\n\n  obra :Obra =new Obra();\n  constructor(private storage:AngularFireStorage,private database:AngularFirestore, private route: ActivatedRoute, private router: Router,public obraService:ObrasService,public notificacionesService: NotificacionesService) { \n    this.uidCliente = this.route.snapshot.paramMap.get('uid');\n    console.log(\"consultando \", this.uidCliente);\n    obraService:ObrasService;\n    this.isUploaded=false;\n    this.isUploading=false;\n    this.imageCollection = database.collection<MyData>('freakyImages');\n    this.images = this.imageCollection.valueChanges();\n\n  }\n\n  ngOnInit() {\n  }\n\n  guardarObra(){\n    console.log(this.uidCliente);\n  \n    try{\n      this.obra.codigocliente=this.uidCliente;\n      this.obra.idImgObra=this.idImgObra;\n      console.log('id IMagen conseguida');\n      console.log(this.idImgObra);\n      this.obraService.saveObra(this.obra);\n      this.notificacionesService.notificacionToast(\"Tu obra se creo correctamente..!  :)\");\n      const url='/view-cliente/'+this.uidCliente;\n      console.log('Sending this route '+url);\n      this.router.navigate([url]);\n    }catch(error){\n      console.error(\"Error tratando de guardar la obra\", error);\n      throw error;\n    \n    }\n  }\n  subirImagen(event:FileList)\n  {\n    const file= event.item(0);\n    if (file.type.split('/')[0]!=='image'){\n      console.log(\"Error formato desconocido :(\")\n      return;\n    }\n    this.isUploading=true;\n    this.isUploaded=false;\n    this.fileName=file.name;\n    const path =`freakyStorage/${new Date().getTime()}_${file.name}`;\n    const customMetadata = {app:'Freaky Image Upload Demo'};\n    const fileRef= this.storage.ref(path);\n    console.log(path);\n    this.task = this.storage.upload(path,file,{customMetadata});\n    console.log(path,file,{customMetadata});\n    this.percentaje = this.task.percentageChanges();\n    this.snapshot=  this.task.snapshotChanges().pipe(\n      finalize(() => {\n        this.UploadedFileURL = fileRef.getDownloadURL();\n        console.log(\"ruta imagen subir \"+this.UploadedFileURL);\n        this.UploadedFileURL.subscribe(resp=>{\n          this.addImagetoDB({\n            name:file.name,\n            filepath:resp,\n            size:this.fileSize,        \n           \n\n          });\n          this.isUploading=false;\n          this.isUploaded =true;\n\n        },error =>{\n          console.error(error);\n        })\n      }),\n      tap(snap=>{\n        this.fileSize = snap.totalBytes;\n      })\n    )\n\n  }\n\n  addImagetoDB(image: MyData) {\n    //Create an ID for document\n    const id = this.database.createId();\n  \n    //Set document id with value in database\n    this.imageCollection.doc(id).set(image).then(resp => {\n      console.log(resp);\n    }).catch(error => {\n      console.log(\"error \" + error);\n    });\n  }\n\n}\n","export default \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2NvbXBvbmVudHMvdGFrZS1waG90by90YWtlLXBob3RvLmNvbXBvbmVudC5zY3NzIn0= */\";","import { Component, Input, OnInit, Output } from '@angular/core';\nimport { Camera, CameraOptions } from '@ionic-native/camera/ngx';\nimport { EventEmitter } from '@angular/core'\nimport { AngularFireStorage } from '@angular/fire/storage';\nimport { LoadingController } from '@ionic/angular';\nimport { filter, finalize, tap } from 'rxjs/operators'\n\n\n@Component({\n  selector: 'app-take-photo',\n  templateUrl: './take-photo.component.html',\n  styleUrls: ['./take-photo.component.scss'],\n})\nexport class TakePhotoComponent implements OnInit {\n\n  @Input() source: string = 'photo';   //posibilidades: photo, gallery\n\n  imageData: string;\n\n  @Output() imageSelected = new EventEmitter<any>();\n  @Output() uploadFinished = new EventEmitter<any>();\n\n  constructor(private camera: Camera,\n      private storage: AngularFireStorage,\n      private loadingCtrl: LoadingController) { }\n\n  ngOnInit() {}\n\n  tomarFoto(){\n    const options: CameraOptions = {\n      quality: 100,\n      destinationType: this.camera.DestinationType.DATA_URL,\n      encodingType: this.camera.EncodingType.JPEG,\n      mediaType: this.camera.MediaType.PICTURE,\n      sourceType: this.camera.PictureSourceType.CAMERA\n    }\n    \n    this.camera.getPicture(options).then((imageData) => {\n     let base64Image = 'data:image/jpeg;base64,' + imageData;\n     this.imageData = base64Image;\n     this.startUpload(imageData);\n    }, (err) => {\n     // Handle error\n    });\n  }\n\n  recuperarImgagen(){\n    const options: CameraOptions = {\n      quality: 100,\n      destinationType: this.camera.DestinationType.DATA_URL,\n      encodingType: this.camera.EncodingType.JPEG,\n      mediaType: this.camera.MediaType.PICTURE,\n      sourceType: this.camera.PictureSourceType.PHOTOLIBRARY\n    }\n    \n    this.camera.getPicture(options).then((imageData) => {\n     let base64Image = 'data:image/jpeg;base64,' + imageData;\n     this.imageData = base64Image;\n     this.startUpload(imageData);\n     this.imageSelected.emit(base64Image);\n    }, (err) => {\n     // Handle error\n    });\n  }\n\n  async startUpload(file: string){\n    let byteCharacters = atob(file);\n    \n    const path = `images/${new Date().getTime()}.jpg`;\n   \n    let image = 'data:image/jpg;base64,'+file;\n    \n    const data = {\n      ref: path,\n      type: 'image',\n      url: null,\n      name: 'image',\n      size: this.fileSize(Number(byteCharacters.length))\n    }\n\n    try{\n      let ref = this.storage.ref(path);\n      let task = ref.putString(image, 'data_url');\n      const loading = await this.loadingCtrl.create({\n        message: 'Espere, subiendo fotografía...'\n      });  \n      await loading.present(); \n\n      //Listener de progreso de carga\n      task.percentageChanges().pipe(\n        filter(val => val === 100),\n        tap(complete => {\n          setTimeout(() => {\n            loading.dismiss();\n          }, 3500);\n        })\n      ).subscribe();\n\n      task.snapshotChanges().pipe(\n        finalize(() => {\n            let downloadURL = ref.getDownloadURL()\n            downloadURL.subscribe(url => {\n              data.url= url;\n              console.log(\"donload terminado \" + url);\n              this.uploadFinished.emit(data);\n            });\n        })\n      )\n      .subscribe();\n    }catch(error){\n      console.error(JSON.stringify(error));\n      console.error(\"error \");\n      \n    }\n    \n  }\n\n  /**\n   * Redondea un número de bytes a un tamaño legible\n   * @param sizeInBytes Número de bytes\n   */\n  fileSize(sizeInBytes: number) {\n    const units = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n    let power = Math.round(Math.log(sizeInBytes) / Math.log(1024));\n    power = Math.min(power, units.length - 1);\n\n    const size = sizeInBytes / Math.pow(1024, power); // size in new units\n    const formattedSize = Math.round(size * 100) / 100; // keep up to 2 decimals\n    const unit = units[power];\n\n    return size ? `${formattedSize} ${unit}` : '0';\n  }\n\n}\n","export class Obra{\n    \n    uid:string;\n    codigocliente:string;\n    codigoobrero:string;\n    titulo:string;\n    descripcion:string;\n    categoria:string;\n    idImgObra:string;\n    \n    \n}"]}